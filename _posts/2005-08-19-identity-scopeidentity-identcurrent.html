---
layout: post
title: "@@identity, scope_identity(), ident_current"
date: 2005-08-19
comments: false
categories:
 - sql
---

<div class='post'>
I have been seeing more and more posts lately that discuss the pitfalls of @@identity, the boon of using scope_identity(), and never mentioning ident_current. So, consider this my entry into the conversation.<br /><br />I just wanted to clarfiy what the three functions do by reposting a part of the transact-sql reference:<br /><br /><blockquote>IDENT_CURRENT is not limited by scope and session; it is limited to a specified table. IDENT_CURRENT returns the value generated for a specific table in any session and any scope. For more information, see IDENT_CURRENT.<br /><br />SCOPE_IDENTITY and @@IDENTITY will return last identity values generated in any table in the current session. However, SCOPE_IDENTITY returns values inserted only within the current scope; @@IDENTITY is not limited to a specific scope.</blockquote><br /><br />You can learn more about scope_identity at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_sa-ses_6n8p.asp">MSDN - SCOPE_IDENTITY()</a><br /><br />Information on ident_current is at <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/tsqlref/ts_ia-iz_82i1.asp">MSDN - IDENT_CURRENT('tablename')</a><br /><br />The pitfall of @@identity is that you won't necessarilly get the id value back you expect. For instance, if the insert into TABLE A fires a trigger that inserts another value into TABLE B you will get the new id for TABLE B when you really wanted the id from TABLE A<br /><br />SCOPE_IDENITY() will give you the id from TABLE A even though the trigger fired.<br /><br />You can use IDENT_CURRENT to get the id from both tables if you want:<br /><pre name="code" class="sql"><br />select IDENT_CURRENT('tableA') as tableAID, IDENT_CURRENT('tableB') as tableBID<br /></pre></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
yes that is a restriction of IDENT_CURRENT - I don&#39;t know of a way to get a scope dependent identity where you specify the table name.</div>
</div>
<div class='comment'>
<div class='author'>Laury Burr</div>
<div class='content'>
Hi <br /><br />Is the usefulness of IDENT_CURRENT actually restricted by being scope-independent? I&#39;m just wondering how it might be used given the possibility of another user insering a record between your insert and the recall of that identity (other than, perhaps, wanting to be able to ascertain that such an insert has happened, maybe?)<br /><br />I guess I&#39;d like to see a real belt-and-braces - a scope-dependent identity where we actually specify the table name.</div>
</div>
</div>
