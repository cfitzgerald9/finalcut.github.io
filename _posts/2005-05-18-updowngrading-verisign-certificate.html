---
layout: post
title: "Up/Downgrading a Verisign Certificate"
date: 2005-05-18
comments: false
---

<div class='post'>
Yesterday I was tasked with changing a clients verisign certificate. They had a certificate that was due to expire next month and during the renewal process they decided to change the encryption level. To Verisign that is just like buying a new certificate, not renewing an old one, so the process is kind of a pain in the but. Here are the steps I used to get the new certificate, install it on the server, and get the site running.<br /><br />Note: Using IIS 6 - so your milage may vary if your using Apache/other.<br /><h3>Prep Work</h3>Before you even begin to mess with verisign you need to build an CSR or certificate request. However, since I needed to leave the current site up and running with it's older certicate I had to create a new, duplicate, site to build the CSR with:<br /><br /><ol>   <li>create a website in IIS or use Default)</li>   <li>right click on website and select properties</li>   <li>click on the directory security tab</li>   <li>click on the "server certificate" button  - the web server certificate wizard will open</li>   <li>hit next</li>   <li>choose "create a new certificate"</li>   <li>hit next</li>   <li>choose "prepare the request now..."</li>   <li>hit next</li>   <li>enter an easy to remember name</li>   <li>for bit length pick 1024 or 512 (512 if getting a 40bit certificate, else 1024)</li>   <li>leave the rest in default state</li>   <li>hit next</li>   <li>fill in organization and organizational unit</li>   <li>hit next</li>   <li>fill in the common name i.e. (www.mydomain.com)</li>   <li>hit next</li>   <li>fill in the location information</li>   <li>hit next</li>   <li>pick a location to save the request (i leave it default)</li>   <li>hit next</li>   <li>confirm information and hit next</li>   <li>hit finish</li> </ol> <h3>Buying a Certificate</h3>Now you need to go to verisign and follow the instructions there for buying a new certificate.<br />I can't give you step by step instructions because more than likely the website will change before<br />you read this - and I don't have any money to buy another one with (i didn't write down each step when I did it yesterday).<br /><br />At one point they will ask you for your CSR. Open up the file you just created in NOTEPAD or some other very simple text editor that wont change anything about the file. Copy the entire contents of that file into the form field specified by verisign.<br /><br />Wait 1-3 days...<h3>Installing the Certificate</h3> <ol>   <li>Launch ISS manager</li>   <li>right click on website (one you created in last series of steps) and select properties</li>   <li>click on the directory security tab</li>   <li>click on the "server certificate" button  - the web server certificate wizard will open</li>   <li>hit next</li>   <li>select "process the pending request..." (if you dont see this option, your looking at the wrong server/website).</li>   <li>hit next</li>   <li>enter the path to the certificate you received from verisign</li>   <li>hit next</li>   <li>verify certificate is installed properly</li> </ol> Truth be told, steps 9/10 are a little vague there because I can't remember them, and once it is installed you can't really go through it again.<h3>Setting Up Coldfusion (CF)<br /></h3>Now, in my case I also had to configure CF to work with this new website I created. If your reading this odds are you will too. Fortunately for us Macromedia provides a handy tool to do all the dirty work.<br /><br />Note, this will work for Apache as well.<br /><br /><ol>   <li>make sure your current webserver has a unique name (so it is easier to identify)</li>   <li>go to C:\cfusionmx\runtime\bin  (or whatever the equivilant path is on your machine)</li>   <li>launch wsconfig.exe</li>   <li>wait until the config screen actually appears (could take a while).</li>   <li>click add (potentially wait a while again)</li>   <li>select IIS as your webserver (change if you aren't using IIS)</li>   <li>select your new website in the IIS Website dropdown</li>   <li>check the "configure webserver for coldfusion applications" checkbox</li>   <li>hit ok</li>   <li>close the wsconfig window when it finishes</li> </ol> Now, your website/server will have the cfide directory that it needs in order to serve up CF documents properly. All ISAPI mappings will be in place etc. Very handy.<h3>Frontpage Server Extensions</h3>This is assuming your screwed and have to deal with Frontpage Server Extensions in any way.  Hopefully, you dont.  But, just in case here is how to configure your new site to support FPS.<br /><br />Note: this assumes Frontpage Server Extensions are already installed<br /><ol>   <li>open your browser on the server (not in terminal services, vnc, etc)<br />  </li>   <li>go to http://localhost:7283/fpadmdll.dll</li>   <li>choose to "extend" the current site</li>   <li>hit next</li>   <li>wait......</li>   <li>wait......</li>   <li>it may, and probably will, return an error saying the site is currently in use. if so, stop the site, wait a while and try again.</li>   <li>If your lucky your done.  If not, try again, and again, and again.</li> </ol> That's it, a fairly simple guide to getting a certificate, setting up a new website, congifuring it for Coldfusion and torturing yourself with Frontpage Server Extensions.  Hope it helps you!</div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>sophie norris</div>
<div class='content'>
i thought the steps were pretty clear and it&#39;s a great resource.  i just needed help with the location options, thanks for clearing it up.</div>
</div>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
venujakku - I'm not sure how much more information I can provide. What exactly do you need help with?</div>
</div>
<div class='comment'>
<div class='author'>venujakku</div>
<div class='content'>
Thank you, for comment on verisign cirtificate ..But can you give more steps in clearly.<br /><br /><br />Thank you.<br />vneujakku</div>
</div>
</div>
