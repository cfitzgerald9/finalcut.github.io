---
layout: post
title: "IE How I Hate thee (Extend Your Selects Cont..)"
date: 2005-05-27
comments: false
categories:
 - javascript
 - ie
---

<div class='post'>
This is my final post about extending select boxes.  It provides all of the methods I described earlier in their functional equivilant.  However, note that IE does fail miserably one one - the built in HTMLSelectElement.add() method.  By the spec you should be able to pass in an OPTION to select before.  However, if you try that with IE it will crash.  You can only append Options to the end of a select element by default in IE.<br /><br />If you need the functionality to insert elements anywhere into a SELECT box in IE I leave that task for you to finish.  If you look at my first post on the topic it will show you a way to do it that just needs to be converted to functions instead of methods.<br /><br />These will all work in both browsers that I can test against today - with the one caveat already noted (about insertion).<br /><br /><pre name="code" class="jscript"><br />// removes all options from the select box<br />function clearSelect(obj){<br /> while (obj.length &gt; 0) {<br />  obj.remove(0);<br /> }<br />}<br /><br />// changes the selection to a specified position<br />function pickSelect(obj,position){<br /> if(position &gt; obj.length-1) position = obj.length-1;<br /><br /> obj.selectedIndex = position;<br />}<br /><br /><br />// changes the selection to a specific id<br />function pickSelectByID(obj,id){<br /> var idx = 0;<br /> for (idx=0;idx&lt;obj.length;idx++){<br />  if(obj.options[idx].value == id){<br />   pickSelect(obj,idx);<br />   break;<br />  }<br /> }<br />}<br /><br />// changes the selection to a specific text value<br />function pickSelectByText(obj,textValue){<br /> var idx = 0;<br /> for (idx=0;idx&lt;obj.length;idx++){<br />  if(obj.options[idx].text == textValue){<br />   pickSelect(obj,idx);<br />   break;<br />  }<br /> }<br />}<br /><br /><br />// changes the selection to a specific text value<br />function getSelectText(obj){<br /> return obj.options[selectedIndex].text;<br />}<br /><br /><br /><br />// clears a select box and optionaly inserts a first object<br />function initSelect(obj,id,textValue){<br /> clearSelect(obj);<br /> if(textValue){<br />  obj.options[0] = new Option(textValue,id);<br /> }<br />}<br /><br /><br />function insertSelect(obj,id,textValue,position){<br /> var newOpt = new Option(textValue,id);<br /><br /> var oldOpt = null;<br /> <br /> if(!isNaN(position) && position &lt; obj.length-1 && position &gt;= 0) {<br />  oldOpt = obj.options[position];<br /> } <br />  try{ // standards compliant<br />   obj.add(newOpt,oldOpt);<br />  } catch(err){<br />   // ie hack<br />   obj.add(newOpt);<br />  }<br />}<br /></pre></div>
