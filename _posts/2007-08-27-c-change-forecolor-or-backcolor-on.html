---
layout: post
title: "C#: Change ForeColor or BackColor on the actual tab of a TabControl"
date: 2007-08-27
comments: false
categories:
 - .net
 - c#
 - ui
---

<div class='post'>
<p>Exciting? Not exactly - but it is useful.  Amazingly enough you can't just set a property on the tab to change the tab's fore or back color - the forecolor and backcolor properties control the contents of the tab but not the tab label itself.  Here is how you do it:</p><br /><p>First you need to set your tab controls draw mode to TabDrawMode.OwnerDrawFixed - this lets you override the normal drawing method with your own. Then you need to add an event handler to your tab controls DrawItem event <br /></p><br /><br /><pre name="code" class="csharp">            this.tabParamType.DrawMode = TabDrawMode.OwnerDrawFixed;<br>            this.tabParamType.DrawItem += new DrawItemEventHandler(tabParamType_DrawItem);<br><br><br>        void tabParamType_DrawItem(object sender, DrawItemEventArgs e)<br>        {<br>            Color foreColor = System.Drawing.SystemColors.ControlText;<br>            string tabName = this.tabParamType.TabPages[e.Index].Text;<br><br>            // some logic to determine the color of the text - basically if the name contains an asterix make the text red, then make a weak effort to remove the asterix from what we actually show<br>            if (tabName.IndexOf("*") &gt; 0)<br>            {<br>                foreColor = Color.Red;<br>                tabName = tabName.TrimEnd('*');<br>            }<br><br>            UIHelper.DrawTabText(this.tabParamType, e, foreColor, tabName);<br><br>        }<br><br></pre><br /><p><br />Inside that event handler call one of these three methods:<br /></p><br /><pre name="code" class="csharp">        public static void DrawTabText(TabControl tabControl, DrawItemEventArgs e, string caption){<br>            Color backColor = (Color)System.Drawing.SystemColors.Control;<br>            Color foreColor = (Color)System.Drawing.SystemColors.ControlText;<br>            DrawTabText(tabControl, e, backColor, foreColor, caption);<br>        }<br>        public static void DrawTabText(TabControl tabControl, DrawItemEventArgs e, System.Drawing.Color foreColor, string caption)<br>        {<br>            Color backColor = (Color)System.Drawing.SystemColors.Control;<br>            DrawTabText(tabControl, e, backColor, foreColor, caption);<br>        }<br><br>        public static void DrawTabText(TabControl tabControl, DrawItemEventArgs e, System.Drawing.Color backColor, System.Drawing.Color foreColor, string caption)<br>        {<br>            #region setup<br>            Font tabFont;<br>            Brush foreBrush = new SolidBrush(foreColor);<br>            Rectangle r = e.Bounds;<br>            Brush backBrush = new SolidBrush(backColor);<br>            string tabName = tabControl.TabPages[e.Index].Text;<br>            StringFormat sf = new StringFormat();<br>            sf.Alignment = StringAlignment.Center;<br>            #endregion<br><br>            #region drawing<br>            e.Graphics.FillRectangle(backBrush, r);<br><br><br>            r = new Rectangle(r.X, r.Y + 3, r.Width, r.Height - 3);<br>            if (e.Index == tabControl.SelectedIndex)<br>            {<br>                tabFont = new Font(e.Font, FontStyle.Italic);<br>                tabFont = new Font(tabFont, FontStyle.Bold);<br>            }<br>            else<br>            {<br>                tabFont = e.Font;<br>            }<br><br>            e.Graphics.DrawString(caption, tabFont, foreBrush, r, sf);<br>            #endregion<br><br>            #region cleanup<br>            sf.Dispose();<br>            if (e.Index == tabControl.SelectedIndex)<br>            {<br>                tabFont.Dispose();<br>                backBrush.Dispose();<br>            }<br>            else<br>            {<br>                backBrush.Dispose();<br>                foreBrush.Dispose();<br>            }<br>            #endregion<br><br>        }<br></pre><br /><p>Now, I created three versions so that I can optionally pass in the fore or back color - just in case i get in the habit of overriding my tab controls draw mode.</p><br /><p>This technique was based entirely off of a post by <a href="http://rajeshkm.blogspot.com/2006/07/how-to-change-color-of-tab-control-in.html">"Rajesh" on his blog</a></p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>r3m0t</div>
<div class='content'>
Here's a version which is much closer to the behaviour of TabDrawMode.Normal, in terms of the text positioning. In fact, on my machine it is pixel-for-pixel identical. In my case, HotTrack is False, SizeMode is Normal, Multiline is False, and I'm using Windows XP with the Classic theme.<BR/><BR/>http://pastebin.com/f39b309bd</div>
</div>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
I really don't know.  I still haven't experienced this problem and I've used the tab painting technique in a couple projects.<BR/><BR/>Sorry I can't be any more help</div>
</div>
<div class='comment'>
<div class='author'>Guillaume</div>
<div class='content'>
i have the same problem as luke... and not finding any usefull help... any clue ?</div>
</div>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
sorry I've been out of town the past 6 days.<BR/><BR/>I don't really know - I haven't experienced this problem at all.  Perhaps change the size of the rectangle you are painting in.</div>
</div>
<div class='comment'>
<div class='author'>Luke</div>
<div class='content'>
I get a transparent or grey color behind the tabs, is there anyway to change this?</div>
</div>
</div>
