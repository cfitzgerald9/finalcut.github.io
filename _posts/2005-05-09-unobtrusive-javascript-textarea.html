---
layout: post
title: "Unobtrusive Javascript  TextArea maxlength"
date: 2005-05-09
comments: false
categories:
 - javascript
 - maxlength
 - textarea
---

<div class='post'>
One of the biggest failings of the textarea control to me is its lack of a maxlength attribute.  There are plenty of scripts out there that work to simulate a maxlength but they always require adding onkeyup, onkeydown, and/or onblur event handlers.  What  pain!<br /><br />I just want to enter a maxlength="x" and have it be enforced.  Thanks to the wonders of DOM traversal this can be done as easilly as anything else.<br /><br /><pre name="code" class="jscript"><br />&lt;textarea name="briefbio" class="text" maxlength="500"&gt;&lt;/textarea&gt;<br /><br /><br />&lt;script type="text/javascript"&gt;<br /><br /> function textAreasInit(){<br />  var objs = document.getElementsByTagName("textarea");<br />  var oi = 0; //oi is object index<br />  var thisObj;<br /><br />  for (oi=0;oi&lt;objs.length;oi++) {<br />   thisObj = objs[oi];<br />   // note that maxlength is case sensitve<br />   if (thisObj.getAttribute('maxlength')){<br />    thisObj.onkeyup = forceMaxLength;<br />   }<br />   thisObj.onchange = saveEntryValue;<br />  }<br /> }<br /><br /> function forceMaxLength(){<br />  var maxLength = parseInt(this.getAttribute('maxlength'));<br />  if(this.value.length &gt; maxlength){<br />   this.value = this.value.substring(0,maxlength);<br />  }<br /> }<br />&lt;/script&gt;<br /></pre><br />As is the case with most unobtrusive javascript you need the "addEvent" script that will cause the textAreasInit function to be run when the page loads.  Also remember you can combine a bunch of different init methods together.<br /><pre name="code" class="jscript"><br />&lt;script type="text/javascript"&gt;<br /> function addEvent(elm, evType, fn, useCapture)<br /> // addEvent and removeEvent<br /> // cross-browser event handling for IE5+,  NS6 and Mozilla<br /> // By Scott Andrew<br /> {<br />   if (elm.addEventListener){<br />  elm.addEventListener(evType, fn, useCapture);<br />  return true;<br />   } else if (elm.attachEvent){<br />  var r = elm.attachEvent("on"+evType, fn);<br />  return r;<br />   } else {<br />  alert("Handler could not be removed");<br />   }<br /> }<br />&lt;/script&gt;<br /></pre><br /><br />This is called via a very simple line of JS in the &lt;head&gt; section of your site.  The addEvent, forceMaxLength, and textAreasInit functions can be in an external JS file for use whenever you need them.<br /><pre name="code" class="jscript"><br />&lt;script type="text/javascript"&gt;<br /> addEvent(window, "load", textAreasInit);<br />&lt;/script&gt;<br /></pre></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
Thanks Anonymous though I&#39;m not sure why you had to change to much.  I&#39;ve been using the listed script for a long time and it works fine for me.</div>
</div>
<div class='comment'>
<div class='author'>Anonymous</div>
<div class='content'>
This is a working one, had to fix a lot of to make your examples work...<br /><br />function textAreasInit(){<br />    var objs = document.getElementsByTagName(&#39;textarea&#39;);<br />    var oi = 0; //oi is object index<br />    var thisObj;<br /><br />    for (oi=0;oi max_length) {<br />        the_textarea_to_force.value = the_textarea_to_force.value.substring(0, max_length);<br />    }<br />}<br /><br />Then put this somewhere in your HTML between script tags:<br /><br />textAreasInit();</div>
</div>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
Charles just remove the line:<BR/><BR/>thisObj.onchange = saveEntryValue;</div>
</div>
<div class='comment'>
<div class='author'>Charles</div>
<div class='content'>
This didn't work for me at all.  Keeps asking for saveEntryValue.  hmmmm....  :-=(</div>
</div>
<div class='comment'>
<div class='author'>Josh</div>
<div class='content'>
function textAreasInit()<BR/>{<BR/> var fields = document.getElementsByTagName("textarea");<BR/> for(var i=0; i&lt;fields.length; i++)<BR/> {<BR/>  if(fields[i].getAttribute('maxlength') != undefined)<BR/>  {<BR/>   fields[i].onkeyup = function()<BR/>   {<BR/>    var maxLength = parseInt(this.getAttribute('maxlength'));<BR/>    if(this.value.length &gt; maxLength)<BR/>    {<BR/>     this.value = this.value.substring(0,maxLength);<BR/>    }<BR/>   }<BR/>  }<BR/> }<BR/>}</div>
</div>
<div class='comment'>
<div class='author'>frequency-decoder</div>
<div class='content'>
Hey guys,<BR/><BR/>I've atually written a similar maxlength script:<BR/><BR/>http://www.frequency-decoder.com/demo/textarea-maxlength/<BR/><BR/>I passed the required maxlength within the textarea's classname e.g.<BR/><BR/>class="maxlength_50"<BR/><BR/>will give the textarea a maxlength of 50 characters (which has the added benefit of not adding extra attributes to the actual textarea tag).<BR/><BR/>Oh, and it's unobtrusive (pretty much a requirement these days!).<BR/><BR/>Over and out..</div>
</div>
<div class='comment'>
<div class='author'>Dustin Diaz</div>
<div class='content'>
Oops. It's not valid xhtml...<BR/>I was just going over this today thinking of some way to get an unobtrusive way of doing this. The original way I was doing this...<BR/><BR/><I><BR/>function maxIt()<BR/> {<BR/> var tot = 10;<BR/>  if ( this.value.length > tot )<BR/>  this.value = this.value.substr(0,tot);<BR/> }<BR/> function attachIt()<BR/> {<BR/> var ta = document.getElementById('maxed');<BR/> ta.onkeyup = maxIt;<BR/> }<BR/></I><BR/><BR/>but then i ran into the problems of being able to separately pass the total amount as a different value per element. this assumes maxlength at 10... then i couldn't figure out how to pass as an argument and it still being able to use the keyword "this" which almost defeats the whole purpose.<BR/><BR/>I think eventually, the best way, would be to do a style just like yours, and use a class like <B>class="maxlen50"</B> and pull a substr(6) on it. then instead of <B>thisObj.getAttribute('maxlength')</B>, you'd replace it with className</div>
</div>
<div class='comment'>
<div class='author'>Sue</div>
<div class='content'>
I stumbled on this while googling a way to use maxlength with texarea and it works perfectly -- on my single-line fields.  Any clue as to why its not working on my multi-line fields?<BR/><BR/>Any help would be appreciated!  Thanks!!<BR/><BR/>sue at mmcxii dot com</div>
</div>
</div>
