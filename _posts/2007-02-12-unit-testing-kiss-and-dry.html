---
layout: post
title: "Unit Testing - KISS and DRY"
date: 2007-02-12
comments: false
categories:
 - unit-testing
 - design patterns
 - objectmother
---

<div class='post'>
Everyone knows unit testing is a good idea - but, let's face it, some times it can be a real pain in the but.  Writing all that tedious setup code, over and over and over can drive anyone crazy and, perhaps, cause some people to stop writing unit tests.<br /><br />Well, there is a painfully obvious solution to this problem - it's called the <a href="http://www.agilealliance.org/show/910">Object Mother Pattern</a>.  The folks who wrote the linked to pdf explain the pattern well enough that I don't think I should rehash it here.  However, don't let my lack of description stop you from checking it out.  It could very well save you a ton of repetitious typing.<br /><br />Here is an example of a unit test "setup" procedure that could be so much cleaner (and simpler) had I used the ObjectMother pattern when I wrote this test:<br /><pre name="code" class="csharp"><br />  private Client m_client = new Client();<br />  private Agency m_agency = new Agency();<br />  private PPCR m_ppcr = new PPCR();<br />  private Patient m_patient = new Patient();<br />  private MedicationsAdministered m_medsadministered = new MedicationsAdministered();<br />  private MedicationsAdministeredProperty m_medsadminprop = new MedicationsAdministeredProperty();<br />  private Element m_element = new Element();<br />  private ElementValue m_elementvalue = new ElementValue();<br /><br />...<br />  [SetUp]<br />  public void SetUp()<br />  {<br />   m_agency.AddNew();<br />   m_agency.AgencyID = agencyid;<br />   m_agency.AddedBy = adminUserID;<br />   m_agency.AddedDate = new DateTime(2000, 1, 1);<br />   m_agency.UpdatedDate = new DateTime(2000, 1, 1);<br />   m_agency.AgencyNumber = "1";<br />   m_agency.AgencyName = "TEST";<br />   m_agency.AgencyState = "WV";<br />   m_agency.ContractExpiration = new DateTime(2099, 1, 1);<br />   m_agency.UpdatedBy = adminUserID;<br />   m_agency.DeletedInd = false;<br />   m_agency.Save();<br /><br />   m_client.AddNew();<br />   m_client.AgencyID = m_agency.AgencyID;<br />   m_client.ClientID = clientid;<br />   m_client.Title = "Tester";<br />   m_client.Description = "I represent a tester";<br />   m_client.LastConnectDate = DateTime.Now;<br />   m_client.AddedDate = DateTime.Now;<br />   m_client.UpdatedBy = adminUserID;<br />   m_client.UpdatedDate = DateTime.Now;<br />   m_client.DeletedInd = false;<br />   m_client.Save();<br /><br />   m_ppcr.AddNew();<br />   m_ppcr.AgencyID = m_agency.AgencyID;<br />   m_ppcr.PPCRID = ppcrid;<br />   m_ppcr.AddedBy = adminUserID;<br />   m_ppcr.AddedDate = DateTime.Now;<br />   m_ppcr.DeletedInd = false;<br />   m_ppcr.UpdatedBy = adminUserID;<br />   m_ppcr.UpdatedDate = DateTime.Now;<br />   m_ppcr.PPCRNumber = "1";<br />   m_ppcr.Save();<br /><br />   m_patient.AddNew();<br />   m_patient.PPCRID = m_ppcr.PPCRID;<br />   m_patient.PatientID = patientid;<br />   m_patient.PatientNumber = 0;<br />   m_patient.AddedBy = adminUserID;<br />   m_patient.AddedDate = DateTime.Now;<br />   m_patient.DeletedInd = false;<br />   m_patient.UpdatedBy = adminUserID;<br />   m_patient.UpdatedDate = DateTime.Now;<br />   m_patient.Save();<br /><br />   m_element.AddNew();<br />   m_element.ElementID = elementid;<br />   m_element.ElementName = "TESTELEMENT";<br />   m_element.ElementEnum = Element.Elements.WorkRelated.ToString();<br />   m_element.AttributeType = "TEST";<br />   m_element.ElementCode = "TEST";<br />   m_element.AddedBy = adminUserID;<br />   m_element.AddedDate = new DateTime(2000, 1, 1);<br />   m_element.UpdatedDate = new DateTime(2000, 1, 1);<br />   m_element.UpdatedBy = adminUserID;<br />   m_element.DeletedInd = false;<br />   m_element.Save();<br /><br />   m_elementvalue.AddNew();<br />   m_elementvalue.ElementValueID = elementvalueid;<br />   m_elementvalue.AgencyID = m_agency.AgencyID;<br />   m_elementvalue.ElementID = m_element.ElementID;<br />   m_elementvalue.AddedBy = adminUserID;<br />   m_elementvalue.AddedDate = DateTime.Now;<br />   m_elementvalue.UpdatedBy = adminUserID;<br />   m_elementvalue.UpdatedDate = new DateTime(2000, 1, 1);<br />   m_elementvalue.DeletedInd = false;<br />   m_elementvalue.Value = "TESTELEMENT";<br />   m_elementvalue.SortOrder = 0;<br />   m_elementvalue.Save();<br /><br /><br />   m_medsadministered.AddNew();<br />   m_medsadministered.MedicationsAdministeredID = medsadminid;<br />   m_medsadministered.PPCRID = m_ppcr.PPCRID;<br />   m_medsadministered.PatientID = m_patient.PatientID;<br />   m_medsadministered.AddedBy = adminUserID;<br />   m_medsadministered.AddedDate = new DateTime(2000, 1, 1);<br />   m_medsadministered.UpdatedDate = new DateTime(2000, 1, 1);<br />   m_medsadministered.UpdatedBy = adminUserID;<br />   m_medsadministered.DeletedInd = false;<br />   m_medsadministered.Save();<br /><br />   m_medsadminprop.AddNew();<br />   m_medsadminprop.MedicationsAdministeredPropertyID = medsadminpropid;<br />   m_medsadminprop.MedicationsAdministeredID = m_medsadministered.MedicationsAdministeredID;<br />   m_medsadminprop.ElementID = m_element.ElementID;<br />   m_medsadminprop.ElementValueID = m_elementvalue.ElementValueID;<br />   m_medsadminprop.AddedDate = new DateTime(2000, 1, 1);<br />   m_medsadminprop.UpdatedDate = new DateTime(2000, 1, 1);<br />   m_medsadminprop.DeletedInd = false;<br />   m_medsadminprop.Save();<br /><br />  }<br /></pre><br /><br />All of that had to be created and dealt with just so I could test the methods on the MedicationsAdministeredProperty object.  However, had I used the ObjectMother pattern I would have just written <br /><pre name="code" class="csharp"><br />  private MedicationsAdministeredProperty m_medsadminprop = ObjectMother.createNewMedicationAdministeredProperty();<br /></pre><br /><br />Considering a lot of that code (pre ObjectMother) was used to test the MedicationsAdministered Object, the Patient, the PPCR, the Agency, the Client, etc. (just smaller subsets) it should be clear how obvious this pattern is, and thus, how helpful it is.<br /><br />So go on, go read that PDF - a few minutes spent now will save you a ton of time later.</div>
