---
layout: post
title: "ListToQuery UDF"
date: 2009-10-28
comments: false
categories:
 - coldfusion
 - udf
---

<div class='post'>
Today I happened to find myself at CFlib.org - I don't go there often - and I was browsing the newer function submissions just for the heck of it and I came across the function <a href="http://cflib.org/udf/listToQuery">ListToQuery</a> by Russ Spivey.  It's a straight forward enough function but I thought it could be a little cleaner, and potentially a little faster when dealing with large lists.<br /><br />Here is my version:<br /><pre class="coldfusion" name="code"><br />&lt;cffunction name="listToQuery" access="public" returntype="query" output="false"<br />    hint="Converts a list to a single-column query."&gt;<br /><br />        &lt;cfargument name="list" type="string" required="yes" hint="List to convert."&gt;<br />        &lt;cfargument name="delimiters" type="string" required="no" default="," hint="Things that separate list elements."&gt;<br />        &lt;cfargument name="columnName" type="string" required="no" default="column" hint="Name to give query column."&gt;<br />        &lt;cfargument name="includeBlanks" type="boolean" required="no" default="false" hint="include empty elements in the list as empty values in the query"&gt;<br /><br />        &lt;cfset var query = queryNew("")&gt;<br />        &lt;cfset QueryAddColumn(query,arguments. columnName,ListToArray(arguments.list,arguments.delimiters,arguments.includeBlanks))&gt;<br /><br />        &lt;cfreturn query&gt;<br /><br />&lt;/cffunction&gt;<br /></pre><br /><br />Sadly, I couldn't contact Russ directly to share my contribution so hopefully he doesn't mind me sticking this here.  If it weren't for his initial cut at the function I wouldn't have thought to even try and write it.<br /><br /><del>If anyone wants to benchmark the two it would probably be interesting to see if my intuition is correct.</del><br />UPDATE:<br />Ok, well, I benchmarked it with 5000, 10000 and 30000 element lists (I didn't have the patience for a 100,000 element list sorry (i suppose I could optimize my list building). Here were the results:<br /><br />   <table border="1"><thead> <br />   <caption>5000 element list</caption></thead><tbody> <br />   <tr><th>Function</th><th>Time in ms</th></tr> <br />   <tr><td>Using QueryAddColumn</td><td>0</td></tr> <br />   <tr><td>Origional Version</td><td>31</td></tr> <br />   </tbody></table> <br />   <table border="1"><thead> <br />   <caption>10000 element list</caption></thead><tbody> <br />   <tr><th>Function</th><th>Time in ms</th></tr> <br />   <tr><td>Using QueryAddColumn</td><td>47</td></tr> <br />   <tr><td>Origional Version</td><td>235</td></tr> <br />   </tbody></table> <br />   <table border="1"><thead> <br />   <caption>30000 element list</caption></thead><tbody> <br />   <tr><th>Function</th><th>Time in ms</th></tr> <br />   <tr><td>Using QueryAddColumn</td><td>110</td></tr> <br />   <tr><td>Origional Version</td><td>453</td></tr> <br />   </tbody></table></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>Raymond Camden</div>
<div class='content'>
@Felipe: RIAForge isn&#39;t really meant for individual UDFs. CFLib is. :)<br /><br />@Bill: This looks like a good update. Can you email me the code (more as a reminder)? The original author will still get credit, but your new version looks to be significantly faster.</div>
</div>
<div class='comment'>
<div class='author'>Bill</div>
<div class='content'>
Well, I&#39;d prefer to leave the credit with Russ Spivey.  I just tweaked it a bit because I saw an easy optimization.<br /><br />His is already at CFLib - I&#39;ll give it some thought though.  Thanks for the suggestion.</div>
</div>
<div class='comment'>
<div class='author'>Felipe Magalh√£es</div>
<div class='content'>
Hey, guy! You should post this UDF in <a href="http://www.riaforge.org/index.cfm?event=page.category&amp;id=1" rel="nofollow">RiaForge</a>! It would be very helpful! Congratulations man!</div>
</div>
</div>
